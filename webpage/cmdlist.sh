#!/bin/bash

mkdir -p build/genhdr

python3 ../../lib/micropython/py/makeversionhdr.py build/genhdr/mpversion.h

(cd ../../lib/micropython && python3 py/makeversionhdr.py /home/johnn333/Documents/micro/micropython-microbit-v2/src/codal_port/build/genhdr/mpversion.h)

python3 ../../lib/micropython/py/makeversionhdr.py build/genhdr/microbitversion.h.pre

cat build/genhdr/microbitversion.h.pre | sed s/MICROPY_/MICROBIT_/ > build/genhdr/microbitversion.h

python3 ../../lib/micropython/py/makeqstrdefs.py pp arm-none-eabi-gcc -E output build/genhdr/qstr.i.last cflags -I. -I../codal_app -I../../lib -I../../lib/codal/libraries/codal-nrf52/inc/cmsis -I../../lib/codal/libraries/codal-nrf52/nrfx -I../../lib/codal/libraries/codal-nrf52/nrfx/drivers/include -I../../lib/codal/libraries/codal-nrf52/nrfx/hal -I../../lib/codal/libraries/codal-nrf52/nrfx/mdk -I../../lib/micropython -I../../lib/micropython/ports/nrf -Ibuild -Wall -Werror -Wpointer-arith -Wuninitialized -std=c99  -DNRF52833_XXAA -Os -DNDEBUG -mthumb -mtune=cortex-m4 -mcpu=cortex-m4 -g -DMICROPY_ROM_TEXT_COMPRESSION=1 -DNO_QSTR cxxflags -DNO_QSTR sources ../../lib/micropython/py/mpstate.c ../../lib/micropython/py/malloc.c ../../lib/micropython/py/gc.c ../../lib/micropython/py/pystack.c ../../lib/micropython/py/qstr.c ../../lib/micropython/py/vstr.c ../../lib/micropython/py/mpprint.c ../../lib/micropython/py/unicode.c ../../lib/micropython/py/mpz.c ../../lib/micropython/py/reader.c ../../lib/micropython/py/lexer.c ../../lib/micropython/py/parse.c ../../lib/micropython/py/scope.c ../../lib/micropython/py/compile.c ../../lib/micropython/py/emitcommon.c ../../lib/micropython/py/emitbc.c ../../lib/micropython/py/asmbase.c ../../lib/micropython/py/asmx64.c ../../lib/micropython/py/emitnx64.c ../../lib/micropython/py/asmx86.c ../../lib/micropython/py/emitnx86.c ../../lib/micropython/py/asmthumb.c ../../lib/micropython/py/emitnthumb.c ../../lib/micropython/py/emitinlinethumb.c ../../lib/micropython/py/asmarm.c ../../lib/micropython/py/emitnarm.c ../../lib/micropython/py/asmxtensa.c ../../lib/micropython/py/emitnxtensa.c ../../lib/micropython/py/emitinlinextensa.c ../../lib/micropython/py/emitnxtensawin.c ../../lib/micropython/py/formatfloat.c ../../lib/micropython/py/parsenumbase.c ../../lib/micropython/py/parsenum.c ../../lib/micropython/py/emitglue.c ../../lib/micropython/py/persistentcode.c ../../lib/micropython/py/runtime.c ../../lib/micropython/py/runtime_utils.c ../../lib/micropython/py/scheduler.c ../../lib/micropython/py/nativeglue.c ../../lib/micropython/py/pairheap.c ../../lib/micropython/py/ringbuf.c ../../lib/micropython/py/stackctrl.c ../../lib/micropython/py/argcheck.c ../../lib/micropython/py/warning.c ../../lib/micropython/py/profile.c ../../lib/micropython/py/map.c ../../lib/micropython/py/obj.c ../../lib/micropython/py/objarray.c ../../lib/micropython/py/objattrtuple.c ../../lib/micropython/py/objbool.c ../../lib/micropython/py/objboundmeth.c ../../lib/micropython/py/objcell.c ../../lib/micropython/py/objclosure.c ../../lib/micropython/py/objcomplex.c ../../lib/micropython/py/objdeque.c ../../lib/micropython/py/objdict.c ../../lib/micropython/py/objenumerate.c ../../lib/micropython/py/objexcept.c ../../lib/micropython/py/objfilter.c ../../lib/micropython/py/objfloat.c ../../lib/micropython/py/objfun.c ../../lib/micropython/py/objgenerator.c ../../lib/micropython/py/objgetitemiter.c ../../lib/micropython/py/objint.c ../../lib/micropython/py/objint_longlong.c ../../lib/micropython/py/objint_mpz.c ../../lib/micropython/py/objlist.c ../../lib/micropython/py/objmap.c ../../lib/micropython/py/objmodule.c ../../lib/micropython/py/objobject.c ../../lib/micropython/py/objpolyiter.c ../../lib/micropython/py/objproperty.c ../../lib/micropython/py/objnone.c ../../lib/micropython/py/objnamedtuple.c ../../lib/micropython/py/objrange.c ../../lib/micropython/py/objreversed.c ../../lib/micropython/py/objset.c ../../lib/micropython/py/objsingleton.c ../../lib/micropython/py/objslice.c ../../lib/micropython/py/objstr.c ../../lib/micropython/py/objstrunicode.c ../../lib/micropython/py/objstringio.c ../../lib/micropython/py/objtuple.c ../../lib/micropython/py/objtype.c ../../lib/micropython/py/objzip.c ../../lib/micropython/py/opmethods.c ../../lib/micropython/py/sequence.c ../../lib/micropython/py/stream.c ../../lib/micropython/py/binary.c ../../lib/micropython/py/builtinimport.c ../../lib/micropython/py/builtinevex.c ../../lib/micropython/py/builtinhelp.c ../../lib/micropython/py/modarray.c ../../lib/micropython/py/modbuiltins.c ../../lib/micropython/py/modcollections.c ../../lib/micropython/py/modgc.c ../../lib/micropython/py/modio.c ../../lib/micropython/py/modmath.c ../../lib/micropython/py/modcmath.c ../../lib/micropython/py/modmicropython.c ../../lib/micropython/py/modstruct.c ../../lib/micropython/py/modsys.c ../../lib/micropython/py/moduerrno.c ../../lib/micropython/py/modthread.c ../../lib/micropython/py/vm.c ../../lib/micropython/py/bc.c ../../lib/micropython/py/showbc.c ../../lib/micropython/py/repl.c ../../lib/micropython/py/smallint.c ../../lib/micropython/py/frozenmod.c ../../lib/micropython/extmod/machine_bitstream.c ../../lib/micropython/extmod/machine_i2c.c ../../lib/micropython/extmod/machine_mem.c ../../lib/micropython/extmod/machine_pinbase.c ../../lib/micropython/extmod/machine_pulse.c ../../lib/micropython/extmod/machine_pwm.c ../../lib/micropython/extmod/machine_signal.c ../../lib/micropython/extmod/machine_spi.c ../../lib/micropython/extmod/machine_timer.c ../../lib/micropython/extmod/modbluetooth.c ../../lib/micropython/extmod/modbtree.c ../../lib/micropython/extmod/modframebuf.c ../../lib/micropython/extmod/modlwip.c ../../lib/micropython/extmod/modnetwork.c ../../lib/micropython/extmod/modonewire.c ../../lib/micropython/extmod/moduasyncio.c ../../lib/micropython/extmod/modubinascii.c ../../lib/micropython/extmod/moducryptolib.c ../../lib/micropython/extmod/moductypes.c ../../lib/micropython/extmod/moduhashlib.c ../../lib/micropython/extmod/moduheapq.c ../../lib/micropython/extmod/modujson.c ../../lib/micropython/extmod/moduos.c ../../lib/micropython/extmod/moduplatform.c ../../lib/micropython/extmod/modurandom.c ../../lib/micropython/extmod/modure.c ../../lib/micropython/extmod/moduselect.c ../../lib/micropython/extmod/modusocket.c ../../lib/micropython/extmod/modussl_axtls.c ../../lib/micropython/extmod/modussl_mbedtls.c ../../lib/micropython/extmod/modutimeq.c ../../lib/micropython/extmod/moduwebsocket.c ../../lib/micropython/extmod/moduzlib.c ../../lib/micropython/extmod/modwebrepl.c ../../lib/micropython/extmod/network_cyw43.c ../../lib/micropython/extmod/network_lwip.c ../../lib/micropython/extmod/network_ninaw10.c ../../lib/micropython/extmod/network_wiznet5k.c ../../lib/micropython/extmod/uos_dupterm.c ../../lib/micropython/extmod/utime_mphal.c ../../lib/micropython/extmod/vfs.c ../../lib/micropython/extmod/vfs_blockdev.c ../../lib/micropython/extmod/vfs_fat.c ../../lib/micropython/extmod/vfs_fat_diskio.c ../../lib/micropython/extmod/vfs_fat_file.c ../../lib/micropython/extmod/vfs_lfs.c ../../lib/micropython/extmod/vfs_posix.c ../../lib/micropython/extmod/vfs_posix_file.c ../../lib/micropython/extmod/vfs_reader.c ../../lib/micropython/extmod/virtpin.c ../../lib/micropython/shared/libc/abort_.c ../../lib/micropython/shared/libc/printf.c drv_display.c drv_image.c drv_radio.c drv_softtimer.c drv_system.c help.c iters.c main.c microbit_accelerometer.c microbit_button.c microbit_compass.c microbit_display.c microbit_i2c.c microbit_image.c microbit_constimage.c microbit_microphone.c microbit_pin.c microbit_pinaudio.c microbit_pinmode.c microbit_sound.c microbit_soundeffect.c microbit_soundevent.c microbit_speaker.c microbit_spi.c microbit_uart.c microbitfs.c modantigravity.c modaudio.c modlog.c modlove.c modmachine.c modmicrobit.c modmusic.c modmusictunes.c modos.c modpower.c modradio.c modspeech.c modthis.c modutime.c mphalport.c examplemodule.c ../../lib/micropython/shared/readline/readline.c ../../lib/micropython/shared/runtime/gchelper_native.c ../../lib/micropython/shared/runtime/pyexec.c ../../lib/micropython/shared/runtime/stdout_helpers.c /home/johnn333/Documents/micro/micropython-microbit-v2/lib/codal/libraries/codal-nrf52/nrfx/drivers/src/nrfx_nvmc.c /home/johnn333/Documents/micro/micropython-microbit-v2/lib/sam/main.c /home/johnn333/Documents/micro/micropython-microbit-v2/lib/sam/reciter.c /home/johnn333/Documents/micro/micropython-microbit-v2/lib/sam/render.c /home/johnn333/Documents/micro/micropython-microbit-v2/lib/sam/sam.c /home/johnn333/Documents/micro/micropython-microbit-v2/lib/sam/debug.c ../../lib/micropython/py/mpconfig.h mpconfigport.h dependencies ../../lib/micropython/py/mpconfig.h mpconfigport.h changed_sources ../../lib/micropython/py/mpstate.c ../../lib/micropython/py/malloc.c ../../lib/micropython/py/gc.c ../../lib/micropython/py/pystack.c ../../lib/micropython/py/qstr.c ../../lib/micropython/py/vstr.c ../../lib/micropython/py/mpprint.c ../../lib/micropython/py/unicode.c ../../lib/micropython/py/mpz.c ../../lib/micropython/py/reader.c ../../lib/micropython/py/lexer.c ../../lib/micropython/py/parse.c ../../lib/micropython/py/scope.c ../../lib/micropython/py/compile.c ../../lib/micropython/py/emitcommon.c ../../lib/micropython/py/emitbc.c ../../lib/micropython/py/asmbase.c ../../lib/micropython/py/asmx64.c ../../lib/micropython/py/emitnx64.c ../../lib/micropython/py/asmx86.c ../../lib/micropython/py/emitnx86.c ../../lib/micropython/py/asmthumb.c ../../lib/micropython/py/emitnthumb.c ../../lib/micropython/py/emitinlinethumb.c ../../lib/micropython/py/asmarm.c ../../lib/micropython/py/emitnarm.c ../../lib/micropython/py/asmxtensa.c ../../lib/micropython/py/emitnxtensa.c ../../lib/micropython/py/emitinlinextensa.c ../../lib/micropython/py/emitnxtensawin.c ../../lib/micropython/py/formatfloat.c ../../lib/micropython/py/parsenumbase.c ../../lib/micropython/py/parsenum.c ../../lib/micropython/py/emitglue.c ../../lib/micropython/py/persistentcode.c ../../lib/micropython/py/runtime.c ../../lib/micropython/py/runtime_utils.c ../../lib/micropython/py/scheduler.c ../../lib/micropython/py/nativeglue.c ../../lib/micropython/py/pairheap.c ../../lib/micropython/py/ringbuf.c ../../lib/micropython/py/stackctrl.c ../../lib/micropython/py/argcheck.c ../../lib/micropython/py/warning.c ../../lib/micropython/py/profile.c ../../lib/micropython/py/map.c ../../lib/micropython/py/obj.c ../../lib/micropython/py/objarray.c ../../lib/micropython/py/objattrtuple.c ../../lib/micropython/py/objbool.c ../../lib/micropython/py/objboundmeth.c ../../lib/micropython/py/objcell.c ../../lib/micropython/py/objclosure.c ../../lib/micropython/py/objcomplex.c ../../lib/micropython/py/objdeque.c ../../lib/micropython/py/objdict.c ../../lib/micropython/py/objenumerate.c ../../lib/micropython/py/objexcept.c ../../lib/micropython/py/objfilter.c ../../lib/micropython/py/objfloat.c ../../lib/micropython/py/objfun.c ../../lib/micropython/py/objgenerator.c ../../lib/micropython/py/objgetitemiter.c ../../lib/micropython/py/objint.c ../../lib/micropython/py/objint_longlong.c ../../lib/micropython/py/objint_mpz.c ../../lib/micropython/py/objlist.c ../../lib/micropython/py/objmap.c ../../lib/micropython/py/objmodule.c ../../lib/micropython/py/objobject.c ../../lib/micropython/py/objpolyiter.c ../../lib/micropython/py/objproperty.c ../../lib/micropython/py/objnone.c ../../lib/micropython/py/objnamedtuple.c ../../lib/micropython/py/objrange.c ../../lib/micropython/py/objreversed.c ../../lib/micropython/py/objset.c ../../lib/micropython/py/objsingleton.c ../../lib/micropython/py/objslice.c ../../lib/micropython/py/objstr.c ../../lib/micropython/py/objstrunicode.c ../../lib/micropython/py/objstringio.c ../../lib/micropython/py/objtuple.c ../../lib/micropython/py/objtype.c ../../lib/micropython/py/objzip.c ../../lib/micropython/py/opmethods.c ../../lib/micropython/py/sequence.c ../../lib/micropython/py/stream.c ../../lib/micropython/py/binary.c ../../lib/micropython/py/builtinimport.c ../../lib/micropython/py/builtinevex.c ../../lib/micropython/py/builtinhelp.c ../../lib/micropython/py/modarray.c ../../lib/micropython/py/modbuiltins.c ../../lib/micropython/py/modcollections.c ../../lib/micropython/py/modgc.c ../../lib/micropython/py/modio.c ../../lib/micropython/py/modmath.c ../../lib/micropython/py/modcmath.c ../../lib/micropython/py/modmicropython.c ../../lib/micropython/py/modstruct.c ../../lib/micropython/py/modsys.c ../../lib/micropython/py/moduerrno.c ../../lib/micropython/py/modthread.c ../../lib/micropython/py/vm.c ../../lib/micropython/py/bc.c ../../lib/micropython/py/showbc.c ../../lib/micropython/py/repl.c ../../lib/micropython/py/smallint.c ../../lib/micropython/py/frozenmod.c ../../lib/micropython/extmod/machine_bitstream.c ../../lib/micropython/extmod/machine_i2c.c ../../lib/micropython/extmod/machine_mem.c ../../lib/micropython/extmod/machine_pinbase.c ../../lib/micropython/extmod/machine_pulse.c ../../lib/micropython/extmod/machine_pwm.c ../../lib/micropython/extmod/machine_signal.c ../../lib/micropython/extmod/machine_spi.c ../../lib/micropython/extmod/machine_timer.c ../../lib/micropython/extmod/modbluetooth.c ../../lib/micropython/extmod/modbtree.c ../../lib/micropython/extmod/modframebuf.c ../../lib/micropython/extmod/modlwip.c ../../lib/micropython/extmod/modnetwork.c ../../lib/micropython/extmod/modonewire.c ../../lib/micropython/extmod/moduasyncio.c ../../lib/micropython/extmod/modubinascii.c ../../lib/micropython/extmod/moducryptolib.c ../../lib/micropython/extmod/moductypes.c ../../lib/micropython/extmod/moduhashlib.c ../../lib/micropython/extmod/moduheapq.c ../../lib/micropython/extmod/modujson.c ../../lib/micropython/extmod/moduos.c ../../lib/micropython/extmod/moduplatform.c ../../lib/micropython/extmod/modurandom.c ../../lib/micropython/extmod/modure.c ../../lib/micropython/extmod/moduselect.c ../../lib/micropython/extmod/modusocket.c ../../lib/micropython/extmod/modussl_axtls.c ../../lib/micropython/extmod/modussl_mbedtls.c ../../lib/micropython/extmod/modutimeq.c ../../lib/micropython/extmod/moduwebsocket.c ../../lib/micropython/extmod/moduzlib.c ../../lib/micropython/extmod/modwebrepl.c ../../lib/micropython/extmod/network_cyw43.c ../../lib/micropython/extmod/network_lwip.c ../../lib/micropython/extmod/network_ninaw10.c ../../lib/micropython/extmod/network_wiznet5k.c ../../lib/micropython/extmod/uos_dupterm.c ../../lib/micropython/extmod/utime_mphal.c ../../lib/micropython/extmod/vfs.c ../../lib/micropython/extmod/vfs_blockdev.c ../../lib/micropython/extmod/vfs_fat.c ../../lib/micropython/extmod/vfs_fat_diskio.c ../../lib/micropython/extmod/vfs_fat_file.c ../../lib/micropython/extmod/vfs_lfs.c ../../lib/micropython/extmod/vfs_posix.c ../../lib/micropython/extmod/vfs_posix_file.c ../../lib/micropython/extmod/vfs_reader.c ../../lib/micropython/extmod/virtpin.c ../../lib/micropython/shared/libc/abort_.c ../../lib/micropython/shared/libc/printf.c drv_display.c drv_image.c drv_radio.c drv_softtimer.c drv_system.c help.c iters.c main.c microbit_accelerometer.c microbit_button.c microbit_compass.c microbit_display.c microbit_i2c.c microbit_image.c microbit_constimage.c microbit_microphone.c microbit_pin.c microbit_pinaudio.c microbit_pinmode.c microbit_sound.c microbit_soundeffect.c microbit_soundevent.c microbit_speaker.c microbit_spi.c microbit_uart.c microbitfs.c modantigravity.c modaudio.c modlog.c modlove.c modmachine.c modmicrobit.c modmusic.c modmusictunes.c modos.c modpower.c modradio.c modspeech.c modthis.c modutime.c mphalport.c ../../lib/micropython/shared/readline/readline.c ../../lib/micropython/shared/runtime/gchelper_native.c ../../lib/micropython/shared/runtime/pyexec.c ../../lib/micropython/shared/runtime/stdout_helpers.c /home/johnn333/Documents/micro/micropython-microbit-v2/lib/codal/libraries/codal-nrf52/nrfx/drivers/src/nrfx_nvmc.c /home/johnn333/Documents/micro/micropython-microbit-v2/lib/sam/main.c /home/johnn333/Documents/micro/micropython-microbit-v2/lib/sam/reciter.c /home/johnn333/Documents/micro/micropython-microbit-v2/lib/sam/render.c /home/johnn333/Documents/micro/micropython-microbit-v2/lib/sam/sam.c /home/johnn333/Documents/micro/micropython-microbit-v2/lib/sam/debug.c ../../lib/micropython/py/mpconfig.h mpconfigport.h

python3 ../../lib/micropython/py/makeqstrdefs.py split qstr build/genhdr/qstr.i.last build/genhdr/qstr _
touch build/genhdr/qstr.split

python3 ../../lib/micropython/py/makeqstrdefs.py cat qstr _ build/genhdr/qstr build/genhdr/qstrdefs.collected.h

cat ../../lib/micropython/py/qstrdefs.h qstrdefsport.h build/genhdr/qstrdefs.collected.h | sed 's/^Q(.*)/"&"/' | arm-none-eabi-gcc -E -I. -I../codal_app -I../../lib -I../../lib/codal/libraries/codal-nrf52/inc/cmsis -I../../lib/codal/libraries/codal-nrf52/nrfx -I../../lib/codal/libraries/codal-nrf52/nrfx/drivers/include -I../../lib/codal/libraries/codal-nrf52/nrfx/hal -I../../lib/codal/libraries/codal-nrf52/nrfx/mdk -I../../lib/micropython -I../../lib/micropython/ports/nrf -Ibuild -Wall -Werror -Wpointer-arith -Wuninitialized -std=c99  -DNRF52833_XXAA -Os -DNDEBUG -mthumb -mtune=cortex-m4 -mcpu=cortex-m4 -g -DMICROPY_ROM_TEXT_COMPRESSION=1 - | sed 's/^\"\(Q(.*)\)\"/\1/' > build/genhdr/qstrdefs.preprocessed.h
python3 ../../lib/micropython/py/makeqstrdata.py build/genhdr/qstrdefs.preprocessed.h > build/genhdr/qstrdefs.generated.h

python3 ../../lib/micropython/py/makeqstrdefs.py split module build/genhdr/qstr.i.last build/genhdr/module _
touch build/genhdr/moduledefs.split

python3 ../../lib/micropython/py/makeqstrdefs.py cat module _ build/genhdr/module build/genhdr/moduledefs.collected

python3 ../../lib/micropython/py/makemoduledefs.py build/genhdr/moduledefs.collected > build/genhdr/moduledefs.h

python3 ../../lib/micropython/py/makeqstrdefs.py split root_pointer build/genhdr/qstr.i.last build/genhdr/root_pointer _
touch build/genhdr/root_pointers.split

python3 ../../lib/micropython/py/makeqstrdefs.py cat root_pointer _ build/genhdr/root_pointer build/genhdr/root_pointers.collected

python3 ../../lib/micropython/py/make_root_pointers.py build/genhdr/root_pointers.collected > build/genhdr/root_pointers.h

python3 ../../lib/micropython/py/makeqstrdefs.py split compress build/genhdr/qstr.i.last build/genhdr/compress _
touch build/genhdr/compressed.split

python3 ../../lib/micropython/py/makeqstrdefs.py cat compress _ build/genhdr/compress build/genhdr/compressed.collected

python3 ../../lib/micropython/py/makecompresseddata.py build/genhdr/compressed.collected > build/genhdr/compressed.data.h

mkdir -p build//home/johnn333/Documents/micro/micropython-microbit-v2/lib/codal/libraries/codal-nrf52/nrfx/drivers/src/
mkdir -p build//home/johnn333/Documents/micro/micropython-microbit-v2/lib/sam/
mkdir -p build/build/
mkdir -p build/extmod/
mkdir -p build/py/
mkdir -p build/shared/libc/
mkdir -p build/shared/readline/
mkdir -p build/shared/runtime/
